!function(t){"use strict";var e="kinetic-active";window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}),t.support=t.support||{},t.extend(t.support,{touch:"ontouchend"in document});var s=function(){return!1},i=function(e,s){return this.settings=s,this.el=e,this.$el=t(e),this._initElements(),this};i.DATA_KEY="kinetic",i.DEFAULTS={cursor:"move",decelerate:!0,triggerHardware:!1,threshold:0,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},i.prototype.start=function(e){this.settings=t.extend(this.settings,e),this.velocity=e.velocity||this.velocity,this.velocityY=e.velocityY||this.velocityY,this.settings.decelerate=!1,this._move()},i.prototype.end=function(){this.settings.decelerate=!0},i.prototype.stop=function(){this.velocity=0,this.velocityY=0,this.settings.decelerate=!0,t.isFunction(this.settings.stopped)&&this.settings.stopped.call(this)},i.prototype.detach=function(){this._detachListeners(),this.$el.removeClass(e).css("cursor","")},i.prototype.attach=function(){this.$el.hasClass(e)||(this._attachListeners(this.$el),this.$el.addClass(e).css("cursor",this.settings.cursor))},i.prototype._initElements=function(){this.$el.addClass(e),t.extend(this,{xpos:null,prevXPos:!1,ypos:null,prevYPos:!1,mouseDown:!1,throttleTimeout:1e3/this.settings.throttleFPS,lastMove:null,elementFocused:null}),this.velocity=0,this.velocityY=0,t(document).mouseup(t.proxy(this._resetMouse,this)).click(t.proxy(this._resetMouse,this)),this._initEvents(),this.$el.css("cursor",this.settings.cursor),this.settings.triggerHardware&&this.$el.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})},i.prototype._initEvents=function(){var e=this;this.settings.events={touchStart:function(t){var s;e._useTarget(t.target,t)&&(s=t.originalEvent.touches[0],e.threshold=e._threshold(t.target,t),e._start(s.clientX,s.clientY),t.stopPropagation())},touchMove:function(t){var s;e.mouseDown&&(s=t.originalEvent.touches[0],e._inputmove(s.clientX,s.clientY),t.preventDefault&&t.preventDefault())},inputDown:function(t){e._useTarget(t.target,t)&&(e.threshold=e._threshold(t.target,t),e._start(t.clientX,t.clientY),e.elementFocused=t.target,"IMG"===t.target.nodeName&&t.preventDefault(),t.stopPropagation())},inputEnd:function(t){e._useTarget(t.target,t)&&(e._end(),e.elementFocused=null,t.preventDefault&&t.preventDefault())},inputMove:function(t){e.mouseDown&&(e._inputmove(t.clientX,t.clientY),t.preventDefault&&t.preventDefault())},scroll:function(s){t.isFunction(e.settings.moved)&&e.settings.moved.call(e,e.settings),s.preventDefault&&s.preventDefault()},inputClick:function(t){return Math.abs(e.velocity)>0?(t.preventDefault(),!1):void 0},dragStart:function(t){return(!e._useTarget(t.target,t)||!e.elementFocused)&&void 0}},this._attachListeners(this.$el,this.settings)},i.prototype._inputmove=function(e,s){var i=this.$el;if(this.el,(!this.lastMove||new Date>new Date(this.lastMove.getTime()+this.throttleTimeout))&&(this.lastMove=new Date,this.mouseDown&&(this.xpos||this.ypos))){var n=e-this.xpos,a=s-this.ypos;if(this.threshold>0){var o=Math.sqrt(n*n+a*a);if(this.threshold>o)return;this.threshold=0}this.elementFocused&&(t(this.elementFocused).blur(),this.elementFocused=null,i.focus()),this.settings.decelerate=!1,this.velocity=this.velocityY=0;var r=this.scrollLeft(),l=this.scrollTop();this.scrollLeft(this.settings.x?r-n:r),this.scrollTop(this.settings.y?l-a:l),this.prevXPos=this.xpos,this.prevYPos=this.ypos,this.xpos=e,this.ypos=s,this._calculateVelocities(),this._setMoveClasses(this.settings.movingClass),t.isFunction(this.settings.moved)&&this.settings.moved.call(this,this.settings)}},i.prototype._calculateVelocities=function(){this.velocity=this._capVelocity(this.prevXPos-this.xpos,this.settings.maxvelocity),this.velocityY=this._capVelocity(this.prevYPos-this.ypos,this.settings.maxvelocity)},i.prototype._end=function(){this.xpos&&this.prevXPos&&!1===this.settings.decelerate&&(this.settings.decelerate=!0,this._calculateVelocities(),this.xpos=this.prevXPos=this.mouseDown=!1,this._move())},i.prototype._useTarget=function(e,s){return!t.isFunction(this.settings.filterTarget)||!1!==this.settings.filterTarget.call(this,e,s)},i.prototype._threshold=function(e,s){return t.isFunction(this.settings.threshold)?this.settings.threshold.call(this,e,s):this.settings.threshold},i.prototype._start=function(t,e){this.mouseDown=!0,this.velocity=this.prevXPos=0,this.velocityY=this.prevYPos=0,this.xpos=t,this.ypos=e},i.prototype._resetMouse=function(){this.xpos=!1,this.ypos=!1,this.mouseDown=!1},i.prototype._decelerateVelocity=function(t,e){return 0===Math.floor(Math.abs(t))?0:t*e},i.prototype._capVelocity=function(t,e){var s=t;return t>0?t>e&&(s=e):0-e>t&&(s=0-e),s},i.prototype._setMoveClasses=function(t){var e=this.settings,s=this.$el;s.removeClass(e.movingClass.up).removeClass(e.movingClass.down).removeClass(e.movingClass.left).removeClass(e.movingClass.right).removeClass(e.deceleratingClass.up).removeClass(e.deceleratingClass.down).removeClass(e.deceleratingClass.left).removeClass(e.deceleratingClass.right),this.velocity>0&&s.addClass(t.right),this.velocity<0&&s.addClass(t.left),this.velocityY>0&&s.addClass(t.down),this.velocityY<0&&s.addClass(t.up)},i.prototype._move=function(){var e=(this.$el,this.el),s=this,i=s.settings;i.x&&e.scrollWidth>0?(this.scrollLeft(this.scrollLeft()+this.velocity),Math.abs(this.velocity)>0&&(this.velocity=i.decelerate?s._decelerateVelocity(this.velocity,i.slowdown):this.velocity)):this.velocity=0,i.y&&e.scrollHeight>0?(this.scrollTop(this.scrollTop()+this.velocityY),Math.abs(this.velocityY)>0&&(this.velocityY=i.decelerate?s._decelerateVelocity(this.velocityY,i.slowdown):this.velocityY)):this.velocityY=0,s._setMoveClasses(i.deceleratingClass),t.isFunction(i.moved)&&i.moved.call(this,i),Math.abs(this.velocity)>0||Math.abs(this.velocityY)>0?this.moving||(this.moving=!0,window.requestAnimationFrame(function(){s.moving=!1,s._move()})):s.stop()},i.prototype._getScroller=function(){var e=this.$el;return(this.$el.is("body")||this.$el.is("html"))&&(e=t(window)),e},i.prototype.scrollLeft=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollLeft():(e.scrollLeft(t),void(this.settings.scrollLeft=t))},i.prototype.scrollTop=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollTop():(e.scrollTop(t),void(this.settings.scrollTop=t))},i.prototype._attachListeners=function(){var e=this.$el,i=this.settings;t.support.touch&&e.bind("touchstart",i.events.touchStart).bind("touchend",i.events.inputEnd).bind("touchmove",i.events.touchMove),e.mousedown(i.events.inputDown).mouseup(i.events.inputEnd).mousemove(i.events.inputMove),e.click(i.events.inputClick).scroll(i.events.scroll).bind("selectstart",s).bind("dragstart",i.events.dragStart)},i.prototype._detachListeners=function(){var e=this.$el,i=this.settings;t.support.touch&&e.unbind("touchstart",i.events.touchStart).unbind("touchend",i.events.inputEnd).unbind("touchmove",i.events.touchMove),e.unbind("mousedown",i.events.inputDown).unbind("mouseup",i.events.inputEnd).unbind("mousemove",i.events.inputMove),e.unbind("click",i.events.inputClick).unbind("scroll",i.events.scroll).unbind("selectstart",s).unbind("dragstart",i.events.dragStart)},t.Kinetic=i,t.fn.kinetic=function(e,s){return this.each(function(){var n=t(this),a=n.data(i.DATA_KEY),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);a||n.data(i.DATA_KEY,a=new i(this,o)),"string"==typeof e&&a[e](s)})}}(window.jQuery||window.Zepto),function(t,e){function s(t){var e="";if(!(t=parseInt(t,10))||1>t)return e;for(;t;)e+="0",--t;return e}function i(t,e,i){return null==t&&(t=""),t=""+t,(i?t:"")+s(e-t.length)+(i?"":t)}function n(t,e){var s,i=0,n=t.length;for("function"!=typeof e&&(s=e,e=function(t){return t===s});i<n;){if(e(t[i]))return t[i];i+=1}}function a(t,e){var s=0,i=t.length;if(t&&i)for(;s<i&&!1!==e(t[s],s);)s+=1}function o(t,e){var s=0,i=t.length,n=[];if(!t||!i)return n;for(;s<i;)n[s]=e(t[s],s),s+=1;return n}function r(t,e){return o(t,function(t){return t[e]})}function l(t){var e=[];return a(t,function(t){n(e,t)||e.push(t)}),e}function c(t,e){var s=[];return a(t,function(i,n){if(!e(i))return s=t.slice(n),!1}),s}function d(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t}var h;if("function"==typeof require)try{h=require("moment")}catch(t){}if(!h&&t.moment&&(h=t.moment),!h)throw"Moment Duration Format cannot find Moment.js";h.duration.fn.format=function(){var t,e,u,v,p,g;t=[].slice.call(arguments);var f,m,w,y,b,k=d({},this.format.defaults),M=h.duration(this);return k.duration=this,a(t,function(t){"string"==typeof t||"function"==typeof t?k.template=t:"number"==typeof t?k.precision=t:"[object Object]"===Object.prototype.toString.call(t)&&d(k,t)}),u=k.types="[object Array]"===Object.prototype.toString.call(k.types)?k.types:k.types.split(" "),"function"==typeof k.template&&(k.template=k.template.apply(k)),t=new RegExp(o(u,function(t){return k[t].source}).join("|"),"g"),v=function(t){return n(u,function(e){return k[e].test(t)})},e=o(k.template.match(t),function(t,e){var s=v(t);return{index:e,length:t.length,token:"escape"===s?t.replace(k.escape,"$1"):t,type:"escape"===s||"general"===s?null:s}}),f=u,m=l((y=r(e,"type"),b=[],a(y,function(t){t&&b.push(t)}),b)),w=[],a(f,function(t){a(m,function(e){t===e&&w.push(t)})}),(p=l(w)).length?(a(p,function(t,s){var i,n,o,r,l;i=M.as(t),n=0<i?Math.floor(i):Math.ceil(i),o=i-n,r=s+1===p.length,l=!s,a(e,function(e){e.type===t&&(d(e,{value:i,wholeValue:n,decimalValue:o,isLeast:r,isMost:l}),l&&null==k.forceLength&&1<e.length&&(k.forceLength=!0))}),M.subtract(n,t)}),k.trim&&(e=("left"===k.trim?c:function(t,e){return c(t.slice().reverse(),e).reverse()})(e,function(t){return!(t.isLeast||null!=t.type&&t.wholeValue)})),g=!1,"right"===k.trim&&e.reverse(),e=o(e,function(t){var e,n;if(!t.type)return t.token;if(e=(e=t.isLeast&&0>k.precision?(Math.floor(t.wholeValue*Math.pow(10,k.precision))*Math.pow(10,-k.precision)).toString():t.wholeValue.toString()).replace(/^\-/,""),1<t.length&&(g||t.isMost||k.forceLength)&&(e=i(e,t.length)),t.isLeast&&0<k.precision)switch(n=t.decimalValue.toString().replace(/^\-/,"").split(/\.|e\-/),n.length){case 1:e+="."+i(n[0],k.precision,!0).slice(0,k.precision);break;case 2:e+="."+i(n[1],k.precision,!0).slice(0,k.precision);break;case 3:e+="."+i(s(+n[2]-1)+(n[0]||"0")+n[1],k.precision,!0).slice(0,k.precision);break;default:throw"Moment Duration Format: unable to parse token decimal value."}return t.isMost&&0>t.value&&(e="-"+e),g=!0,e}),"right"===k.trim&&e.reverse(),e.join("")):r(e,"token").join("")},h.duration.fn.format.defaults={escape:/\[(.+?)\]/,years:/[Yy]+/,months:/M+/,weeks:/[Ww]+/,days:/[Dd]+/,hours:/[Hh]+/,minutes:/m+/,seconds:/s+/,milliseconds:/S+/,general:/.+?/,types:"escape years months weeks days hours minutes seconds milliseconds general",trim:"left",precision:0,forceLength:null,template:function(){var t=this.duration;switch(function(t,e){for(var s=t.length;--s;)if(e(t[s]))return t[s]}(this.types,function(e){return t._data[e]})){case"seconds":return"h:mm:ss";case"minutes":return"d[d] h:mm";case"hours":return"d[d] h[h]";case"days":return"M[m] d[d]";case"weeks":return"y[y] w[w]";case"months":return"y[y] M[m]";case"years":return"y[y]";default:return"y[y] M[m] d[d] h:mm:ss"}}}}(this),function(t){t.fn.ganttView=function(){var n=Array.prototype.slice.call(arguments);1==n.length&&"object"==typeof n[0]&&function(n){var a=this,o=t.extend(!0,{showWeekends:!0,showToday:!0,toggleProjects:!0,cellWidth:20,slideWidth:400,kineticScroll:!0,startDate:!1,endDate:!1,startToday:!1,behavior:{clickable:!1,draggable:!0,resizable:!0}},n);o.data?r():o.dataUrl&&t.getJSON(o.dataUrl,function(t){o.data=t,r()});function r(){var n=Math.floor(o.slideWidth/o.cellWidth+5),r=i.getBoundaryDatesFromData(o.data,n);o.start=o.startDate?moment(o.startDate,"MM/DD/YYYY")._d:r[0],o.end=o.endDate?moment(o.endDate,"MM/DD/YYYY")._d:r[1],a.each(function(){var i=t(this),n=t("<div>",{class:"ganttview"});new e(n,o).render(),i.append(n);t("div.ganttview-vtheader",i).outerWidth(),t("div.ganttview-slide-container",i).outerWidth();new s(i,o).apply()})}}.call(this,n[0]),2==n.length&&"string"==typeof n[0]&&function(t,e){if("setSlideWidth"==t){var s=$("div.ganttview",this);s.each(function(){var t=$("div.ganttview-vtheader",s).outerWidth();$(s).width(t+e+1),$("div.ganttview-slide-container",this).width(e)})}}.call(this,n[0],n[1])};var e=function(e,s){function n(e,s,i){var n={name:s.name};t.extend(n,i),e.data("block-data",n)}return{render:function(){!function(e,s){for(var i=t("<div>",{class:"ganttview-vtheader"}),n=0;n<s.length;n++){var a=t("<div>",{class:"ganttview-vtheader-group"});a.append(t("<div>",{class:"ganttview-vtheader-group-name",id:"groupId_"+n}).append(s[n].name).append("<span/>"));for(var o=t("<div>",{class:"ganttview-vtheader-series"}),r=0;r<s[n].series.length;r++){var l=t("<div>",{class:"ganttview-vtheader-series-row"});if(s[n].series[r].sub_series){var c=t("<div>",{class:"series-content"}),d=t("<div>",{class:"series-dates"});series_users=t("<div>",{class:"series-users"}),c.append('<div class="series-name">'+s[n].series[r].name+"</div>");for(var h=0;h<s[n].series[r].sub_series.length;h++){var u=h>0?'<span class="date-sep">|</span>':"",v=s[n].series[r].sub_series[h];if(v.user_avatar){var p=t("<div>",{class:"series-user"});v.user_name,user_avatar=v.user_avatar,p.append('<span><img src="'+user_avatar+'"/></span>'),series_users.append(p),l.append(series_users)}d.append(function(){return u+"<span data-event-id='"+s[n].series[r].sub_series[h].id+"'>"+moment(v.start,"MM/DD/YYYY").format("D MMM")+" - "+moment(v.end,"MM/DD/YYYY").format("D MMM")+"</span>"}),c.append(d),l.append(c)}}else l.append(function(){var t=s[n].series[r].user_avatar?"<div class='series-user'><span><img src='"+s[n].series[r].user_avatar+"' /></span></div>":"";return t+"<div class='series-content'><div class=\"series-name\">"+s[n].series[r].name+"</div><div class='series-dates'><span data-event-id='"+s[n].series[r].id+"'>"+moment(s[n].series[r].start,"MM/DD/YYYY").format("D MMM")+" - "+moment(s[n].series[r].end,"MM/DD/YYYY").format("D MMM")+"</span></div></div>"});o.append(l)}a.append(o),i.append(a)}e.append(i)}(e,s.data);var a,o,r,l=t("<div>",{class:"ganttview-slide-container"});dates=function(t,e){var s=[];s[t.getFullYear()]=[],s[t.getFullYear()][t.getMonth()]=[t];for(var i=t;moment(e).isAfter(i);){var n=moment(i).add(1,"days")._d;s[n.getFullYear()]||(s[n.getFullYear()]=[]),s[n.getFullYear()][n.getMonth()]||(s[n.getFullYear()][n.getMonth()]=[]),s[n.getFullYear()][n.getMonth()].push(n),i=n}return s}(s.start,s.end),function(e,s,n,a,o,r){var l=t("<div>",{class:"ganttview-hzheader"}),c=t("<div>",{class:"ganttview-hzheader-months"}),d=t("<div>",{class:"ganttview-hzheader-days"}),h=0;for(var u in s)for(var v in s[u]){var p=s[u][v].length*n;h+=p,c.append(t("<div>",{class:"ganttview-hzheader-month",css:{width:p-1+"px"}}).append(moment(parseInt(v)+1,"M").format("MMMM")+" "+u));for(var g in s[u][v]){var f=t("<div>",{class:"ganttview-hzheader-day"});i.isWeekend(s[u][v][g])&&a&&f.addClass("ganttview-weekend"),moment(s[u][v][g]).isSame(Date.now(),"day")&&o&&f.addClass("ganttview-today"),moment(s[u][v][g]).isSame(Date.now(),"day")&&r&&f.addClass("ganttview-startToday"),d.append(f.append(s[u][v][g].getDate()))}}c.css("width",h+"px"),d.css("width",h+"px"),l.append(c).append(d),e.append(l)}(l,dates,s.cellWidth,s.showWeekends,s.showToday,s.startToday),function(e,s,n,a,o,r){var l=t("<div>",{class:"ganttview-grid"}),c=t("<div>",{class:"ganttview-grid-row"});for(var d in n)for(var h in n[d])for(var u in n[d][h]){var v=t("<div>",{class:"ganttview-grid-row-cell"});i.isWeekend(n[d][h][u])&&o&&v.addClass("ganttview-weekend"),moment(n[d][h][u]).isSame(Date.now(),"day")&&r&&v.addClass("ganttview-today"),c.append(v)}var p=t("div.ganttview-grid-row-cell",c).length*a;c.css("width",p+"px"),l.css("width",p+"px");for(var g=0;g<s.length;g++){l.append(t("<div>",{class:"ganttview-grid-spacer","data-click-target":"groupId_"+g}));for(var f=0;f<s[g].series.length;f++)l.append(c.clone().addClass("groupId_"+g))}e.append(l)}(l,s.data,dates,s.cellWidth,s.showWeekends,s.showToday),function(e,s){for(var i=t("<div>",{class:"ganttview-blocks"}),n=0;n<s.length;n++){i.append(t("<div>",{class:"ganttview-block-spacer"}));for(var a=0;a<s[n].series.length;a++)i.append(t("<div>",{class:"ganttview-block-container groupId_"+n}))}e.append(i)}(l,s.data),function(e,s,a,o){for(var r=t("div.ganttview-blocks div.ganttview-block-container",e),l=0,c=0;c<s.length;c++)for(var d=0;d<s[c].series.length;d++){if(s[c].series[d].sub_series){var h=s[c].series[d].sub_series,u=s[c].series[d].name.replace(/(<([^>]+)>)/gi," ");$.each(h,function(e,d){var v=i.daysBetween(d.start,d.end)+1,p=i.daysBetween(o,d.start),g=d.user_name?" ("+d.user_name+")":"",f=t("<div>",{class:"ganttview-block",title:u+g,"data-id":d.id,css:{width:v*a-7+"px",left:p*a+3+"px"}});n(f,s[c],h[e]),d.color&&f.css("background-color",d.color);var m=d.title?d.link?'<a href="'+d.link+'" title="'+d.link+'">'+d.title+"</a>":d.title:moment.duration(v,"days").format();d.link?f.append(t("<div>",{class:"ganttview-block-text"}).html(m)):f.append(t("<div>",{class:"ganttview-block-text"}).text(m)),t(r[l]).append(f)})}else{var v=s[c].series[d],p=v.name.replace(/(<([^>]+)>)/gi," "),g=i.daysBetween(v.start,v.end)+1,f=i.daysBetween(o,v.start),m=t("<div>",{class:"ganttview-block",title:p,css:{width:g*a-7+"px",left:f*a+3+"px"}});n(m,s[c],v),s[c].series[d].color&&m.css("background-color",s[c].series[d].color);var w=v.title?v.link?'<a href="'+v.link+'" title="'+v.link+'">'+v.title+"</a>":v.title:moment.duration(g,"days").format();v.link?m.append(t("<div>",{class:"ganttview-block-text"}).html(w)):m.append(t("<div>",{class:"ganttview-block-text"}).text(w)),t(r[l]).append(m)}l++}t(".ganttview-blocks").css({width:$(e).width()})}(l,s.data,s.cellWidth,s.start),e.append(l),t(e).find(".ganttview-blocks").width(l.find(".ganttview-grid").width()),a=e.parent(),t("div.ganttview-grid-row div.ganttview-grid-row-cell:last-child",a).addClass("last"),t("div.ganttview-hzheader-days div.ganttview-hzheader-day:last-child",a).addClass("last"),t("div.ganttview-hzheader-months div.ganttview-hzheader-month:last-child",a).addClass("last"),s.toggleProjects&&(o=e,$("div.ganttview-vtheader-group-name",o).addClass("toggle_enabled").on("click",function(){$thisId=$(this).attr("id"),$(this).hasClass("projectHidden")?($(this).removeClass("projectHidden").next("div").children().velocity("slideDown",{duration:180,easing:easing_swiftOut}),$(".ganttview-block-container."+$thisId).show(),$(".ganttview-grid-row."+$thisId).velocity("slideDown",{duration:180,easing:easing_swiftOut})):($(this).addClass("projectHidden").next("div").children().velocity("slideUp",{duration:180,easing:easing_swiftOut}),$(".ganttview-block-container."+$thisId).hide(),$(".ganttview-grid-row."+$thisId).velocity("slideUp",{duration:180,easing:easing_swiftOut}))}),$("div.ganttview-grid-spacer",o).on("click",function(){$("#"+$(this).attr("data-click-target")).click()})),s.kineticScroll&&!Modernizr.touch&&(r=t("div.ganttview-slide-container",e),$(r).kinetic({y:!1,filterTarget:function(t,e){return!($(t).closest(".ganttview-block").length||$(t).closest(".ganttview-grid-spacer").length)}})),s.startToday&&setTimeout(function(){var t=i.daysBetween(s.start,moment()._d);l.scrollLeft(t*s.cellWidth)},100)}}},s=function(e,s){function i(e,s,i,n){var a=t("div.ganttview-slide-container",e),o=a.scrollLeft(),r=s.offset().left-a.offset().left-1+o,l=Math.round(r/i),c=moment(n).add(l,"days");s.data("block-data").start=c;var d=s.outerWidth(),h=Math.round(d/i)-1;s.data("block-data").end=moment(c).add(h,"days"),s.data("block-data").title||t("div.ganttview-block-text",s).text(moment.duration(h+1,"days").format())}return{apply:function(){var n,a,o,r,l,c,d,h,u,v;s.behavior.clickable&&(n=e,a=s.behavior.onClick,t("div.ganttview-block",n).on("click",function(){a&&a(t(this).data("block-data"))})),s.behavior.resizable&&(o=e,r=s.cellWidth,l=s.start,c=s.behavior.onResize,t("div.ganttview-block",o).resizable({grid:r,handles:"e,w",stop:function(){var e=t(this);i(o,e,r,l);var s=e.data("block-data");o.find("[data-event-id="+s.id+"]").text(moment(s.start).format("D MMM")+" - "+moment(s.end).format("D MMM")),c&&c(e.data("block-data"))}})),s.behavior.draggable&&(d=e,h=s.cellWidth,u=s.start,v=s.behavior.onDrag,t("div.ganttview-block",d).draggable({axis:"x",grid:[h,h],containment:"parent",stop:function(){var e=t(this);i(d,e,h,u);var s=e.data("block-data");d.find("[data-event-id="+s.id+"]").text(moment(s.start).format("D MMM")+" - "+moment(s.end).format("D MMM")),v&&v(e.data("block-data"))}}))}}},i={daysBetween:function(t,e){return t&&e?(t=Date.parse(t),e=Date.parse(e),1901==moment(t)._d.getYear()||8099==moment(e)._d.getYear()?0:moment(e).diff(moment(t),"days")):0},isWeekend:function(t){return t.getDay()%6==0},getBoundaryDatesFromData:function(t,e){var s=new Date,i=new Date,n=[];return t.forEach(function(t){t.series.forEach(function(t){t.sub_series?t.sub_series.forEach(function(t){n.push(t)}):n.push(t)})}),n.forEach(function(t,e){var n=Date.parse(t.start),a=Date.parse(t.end);0==e&&(s=n,i=a),moment(s).isAfter(n)&&(s=n),moment(i).isBefore(a)&&(i=a)}),moment(i).diff(s,"days")<e&&(i=moment(s).add(e,"days")),[moment(s)._d,moment(i)._d]}}}(jQuery);